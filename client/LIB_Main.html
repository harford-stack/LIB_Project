<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>가을날의 서재 - 메인</title>
    <link rel="stylesheet" href="LIB_Style_Mobile.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script>
        // 헤더와 푸터를 동적으로 불러오는 함수
        function loadHeaderFooter() {
            // 헤더 로드
            fetch('LIB_Header.html')
                .then(response => response.text())
                .then(data => {
                    // LIB_Header.html에서 <header> 태그 부분만 추출하여 삽입
                    const headerContent = new DOMParser()
                        .parseFromString(data, 'text/html')
                        .querySelector('header');
                    document.getElementById('header-container').appendChild(headerContent);
                });
            
            // 푸터 로드
            fetch('LIB_Footer.html')
                .then(response => response.text())
                .then(data => {
                    // LIB_Footer.html에서 <footer> 태그 부분만 추출하여 삽입
                    const footerContent = new DOMParser()
                        .parseFromString(data, 'text/html')
                        .querySelector('footer');
                    document.getElementById('footer-container').appendChild(footerContent);
                });
        }
    </script>
</head>
<body onload="loadHeaderFooter()">
    <!-- Vue 앱 전체를 <main> 태그로 감싸고, id="app"은 유지 -->
    <main id="app">
        <div id="header-container"></div>
        <div id="main-content">
            
            <div>
                <!-- 로그인 상태에 따라 다른 메시지 표시 -->
                <h2 v-if="sessionId">환영합니다, {{ userName }}님!</h2>
                <h2 v-else>환영합니다!</h2>
                <!-- 로그인 여부에 따라 버튼 다르게 표시 -->
                <template v-if="sessionId">
                    <!-- 클래스 이름 변경: primary -> btn-primary, secondary -> btn-back-to-main (컨셉에 따라) -->
                    <button class="btn-primary" @click="goToMyReservations">내 예약 확인</button>
                    <button class="btn-primary" @click="goToMyPage">회원정보 수정</button>
                    <button class="btn-back-to-main" @click="logout">로그아웃</button>
                </template>
                <template v-else>
                    <button class="btn-primary" @click="goToLoginPage">로그인</button>
                    <button class="btn-back-to-main" @click="goToJoinPage">회원가입</button>
                </template>
                <!-- 좌석 예약 버튼도 btn-primary로 -->
                <button class="btn-primary" @click="goToSeatBooking">좌석 예약</button>
            </div>
        </div>
        <div id="footer-container"></div>
    </main>
</body>
</html>

<script>
    const app = Vue.createApp({
        data() {
            return {
                userName: "",
                sessionId: ""
            };
        },
        methods: {
            logout: function() {
                sessionStorage.removeItem("sessionId");
                sessionStorage.removeItem("sessionName");
                alert("로그아웃 되었습니다.");
                // 로그아웃 후 페이지를 새로고침하여 비로그인 상태 UI 표시
                window.location.reload(); 
            },
            goToMyPage: function() {
                location.href = "LIB_MyPage.html";
            },
            goToSeatBooking: function() {
                location.href = "LIB_Reservation.html";
            },
            goToLoginPage: function() {
                location.href = "LIB_Login.html";
            },
            goToJoinPage: function() {
                location.href = "LIB_Join.html";
            },
            goToMyReservations: function() {
                location.href = "LIB_MyReservations.html";
            }
        },
        mounted() {
            let self = this;
            // 페이지 로드 시 세션 스토리지에서 사용자 정보 가져오기
            self.sessionId = sessionStorage.getItem("sessionId");
            self.userName = sessionStorage.getItem("sessionName");
        }
    });

    app.mount('#app');
</script>